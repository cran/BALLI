<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Quick start of BALLI package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quick start of BALLI package</h1>



<div id="quick-start" class="section level1">
<h1>Quick Start</h1>
<p>This is an quick start manual of <strong>BALLI</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">require</span>(BALLI)</a></code></pre></div>
<div id="load-count-data" class="section level3">
<h3>1. Load Count Data</h3>
<pre><code>data &lt;- data.frame(read.table(&quot;counts.txt&quot;))</code></pre>
<p>or make example count data</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">GenerateData &lt;-<span class="st"> </span><span class="cf">function</span>(nRow) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">    expr_mean &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    expr_size &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    expr &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">20</span>,<span class="dt">mu=</span>expr_mean,<span class="dt">size=</span>expr_size)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    <span class="kw">return</span>(expr)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>,GenerateData)))</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;A&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>),<span class="kw">paste0</span>(<span class="st">&quot;B&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw">rownames</span>(data) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;gene&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">head</span>(data)</a></code></pre></div>
<pre><code>##       A1 A2  A3  A4 A5  A6  A7  A8  A9 A10  B1  B2  B3 B4  B5  B6 B7  B8
## gene1  7 39  16  80 48  40 128  48  14  59 160  46  23 63  24 108 40  19
## gene2 33 39 112  24 74  61 167 124  89  95  95 151 206 54 224  66 45 110
## gene3 82 68  39 159 43 103  67 102 182  47  97  97  93 60  74  82 70 109
## gene4 13 18  14  15  6  20  17  11  11   6  13  15   2 12  12  17 13  14
## gene5 10 14  40  26 19  22  19  22  27  20  13   9  17 25  18  12 15  54
## gene6 50 71  20  13 22  10  26  23  10  40  13  22  16 43  42  30 35  43
##       B9 B10
## gene1 22  68
## gene2 75  62
## gene3 56  34
## gene4  5  20
## gene5 16  23
## gene6 26  33</code></pre>
</div>
<div id="designate-group-information-and-make-design-matrix" class="section level3">
<h3>2. Designate Group Information and Make Design Matrix</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">Group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>,<span class="dv">10</span>),<span class="kw">rep</span>(<span class="st">&quot;B&quot;</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">Group</a></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;
## [18] &quot;B&quot; &quot;B&quot; &quot;B&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">design &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Group, <span class="dt">data =</span> data)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">head</span>(design)</a></code></pre></div>
<pre><code>##   (Intercept) GroupB
## 1           1      0
## 2           1      0
## 3           1      0
## 4           1      0
## 5           1      0
## 6           1      0</code></pre>
</div>
<div id="normalize-count-data" class="section level3">
<h3>3. Normalize Count Data</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">dge &lt;-<span class="st"> </span><span class="kw">DGEList</span>(<span class="dt">counts=</span>data, <span class="dt">group=</span>Group)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">dge &lt;-<span class="st"> </span><span class="kw">calcNormFactors</span>(dge)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">dge</a></code></pre></div>
<pre><code>## An object of class &quot;DGEList&quot;
## $counts
##       A1 A2  A3  A4 A5  A6  A7  A8  A9 A10  B1  B2  B3 B4  B5  B6 B7  B8
## gene1  7 39  16  80 48  40 128  48  14  59 160  46  23 63  24 108 40  19
## gene2 33 39 112  24 74  61 167 124  89  95  95 151 206 54 224  66 45 110
## gene3 82 68  39 159 43 103  67 102 182  47  97  97  93 60  74  82 70 109
## gene4 13 18  14  15  6  20  17  11  11   6  13  15   2 12  12  17 13  14
## gene5 10 14  40  26 19  22  19  22  27  20  13   9  17 25  18  12 15  54
##       B9 B10
## gene1 22  68
## gene2 75  62
## gene3 56  34
## gene4  5  20
## gene5 16  23
## 9995 more rows ...
## 
## $samples
##    group lib.size norm.factors
## A1     A   551929    0.9939824
## A2     A   554250    1.0019442
## A3     A   551469    0.9964722
## A4     A   551560    1.0071093
## A5     A   546462    0.9998596
## 15 more rows ...</code></pre>
</div>
<div id="estimate-technical-variance" class="section level3">
<h3>4. Estimate Technical Variance</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">tV &lt;-<span class="st"> </span><span class="kw">tecVarEstim</span>(dge,design)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">tV</a></code></pre></div>
<pre><code>## An object of class &quot;TecVarList&quot;
## $targets
##    group lib.size norm.factors
## A1     A 548607.7    0.9939824
## A2     A 555327.6    1.0019442
## A3     A 549523.5    0.9964722
## A4     A 555481.2    1.0071093
## A5     A 546385.3    0.9998596
## 15 more rows ...
## 
## $design
##   (Intercept) GroupB
## 1           1      0
## 2           1      0
## 3           1      0
## 4           1      0
## 5           1      0
## 15 more rows ...
## 
## $logcpm
##             A1       A2       A3       A4       A5       A6       A7
## gene1 4.034259 6.206591 5.033024 7.205971 6.515297 6.237959 7.888394
## gene2 5.994961 6.206591 7.696526 5.549376 7.119559 6.822715 8.266935
## gene3 7.258266 6.978131 6.221008 8.179219 6.363232 7.559515 6.974440
## gene4 4.771948 5.171450 4.863019 4.936799 3.868508 5.305636 5.113222
## gene5 4.449749 4.849758 6.255780 5.656237 5.262988 5.431069 5.257693
##             A8       A9      A10       B1       B2       B3       B4
## gene1 6.510839 4.849230 6.797026 8.221498 6.447280 5.477148 6.882641
## gene2 7.844489 7.355990 7.466305 7.481365 8.119834 8.531824 6.667616
## gene3 7.567617 8.371645 6.480929 7.510818 7.491771 7.401550 6.814466
## gene4 4.566359 4.549959 3.864428 4.785661 4.949437 2.844617 4.667364
## gene5 5.451541 5.706648 5.325222 4.785661 4.321116 5.081903 5.615058
##             B5       B6       B7       B8       B9      B10
## gene1 5.559786 7.627629 6.240335 5.251725 5.455301 6.978569
## gene2 8.679625 6.933867 6.402553 7.666884 7.137895 6.849310
## gene3 7.107348 7.238655 7.017734 7.653945 6.728975 6.019453
## gene4 4.666604 5.095240 4.755808 4.859361 3.674976 5.309277
## gene5 5.181240 4.655118 4.936215 6.666856 5.039891 5.493604
## 9995 more rows ...
## 
## $tecVar
##               A1         A2         A3         A4         A5         A6
## gene1 0.02433482 0.02404494 0.02429490 0.02403839 0.02443225 0.02398665
## gene2 0.01290915 0.01276419 0.01288908 0.01276092 0.01295810 0.01273506
## gene3 0.01157954 0.01144914 0.01156159 0.01144619 0.01162334 0.01142290
## gene4 0.06724111 0.06647979 0.06713630 0.06646259 0.06749685 0.06632664
## gene5 0.04159129 0.04110131 0.04152382 0.04109025 0.04175595 0.04100278
##               A7         A8         A9        A10         B1          B2
## gene1 0.02433497 0.02435499 0.02403503 0.02434190 0.01994302 0.019683524
## gene2 0.01290922 0.01291928 0.01275924 0.01291270 0.00991243 0.009788362
## gene3 0.01157961 0.01158861 0.01144467 0.01158272 0.01245367 0.012299260
## gene4 0.06724149 0.06729405 0.06645375 0.06725969 0.07659121 0.075636970
## gene5 0.04159154 0.04162538 0.04108456 0.04160325 0.04821743 0.047601141
##                B3          B4          B5          B6          B7
## gene1 0.019272708 0.019654898 0.019643162 0.019466946 0.019486113
## gene2 0.009591265 0.009774668 0.009769053 0.009684516 0.009693714
## gene3 0.012053776 0.012282216 0.012275228 0.012169979 0.012181437
## gene4 0.074120695 0.075531652 0.075488473 0.074838233 0.074909017
## gene5 0.046619411 0.047532925 0.047504959 0.047083888 0.047129718
##                B8          B9         B10
## gene1 0.019644458 0.019802616 0.019505915
## gene2 0.009769673 0.009845315 0.009703217
## gene3 0.012275999 0.012370146 0.012193274
## gene4 0.075493239 0.076075022 0.074982142
## gene5 0.047508046 0.047884242 0.047177065
## 9995 more rows ...</code></pre>
</div>
<div id="fit-balli-and-see-top-significant-genes" class="section level3">
<h3>5. Fit BALLI and See Top Significant Genes</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">balli</span>(tV,<span class="dt">intV=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">fit</a></code></pre></div>
<pre><code>## An object of class &quot;Balli&quot;
## $Result
##       log2FC_GroupB      lLLI    lBALLI      pLLI    pBALLI       BCF
## gene1     0.2862964 0.3791686 0.3370391 0.5380485 0.5615433 0.1249988
## gene2     0.4147916 1.3275686 1.1800625 0.2492382 0.2773433 0.1249985
## gene3    -0.0970422 0.1338105 0.1189427 0.7145134 0.7301840 0.1249997
## gene4    -0.1410062 0.2757014 0.2450759 0.5995326 0.6205638 0.1249635
## gene5    -0.1870295 0.5887311 0.5233292 0.4429102 0.4694250 0.1249728
## 9995 more rows ...
## 
## $topGenes
##          log2FC_GroupB         pLLI       pBALLI   adjpLLI adjpBALLI
## gene6890    -0.8492182 1.197256e-05 3.663179e-05 0.1121975 0.3204511
## gene7128     0.9149524 2.243950e-05 6.409023e-05 0.1121975 0.3204511
## gene3277    -1.2590606 8.539749e-05 2.121336e-04 0.2846583 0.6766089
## gene7092    -1.5531435 1.637869e-04 3.799606e-04 0.3555333 0.6766089
## gene4606     1.4661759 2.563216e-04 5.668673e-04 0.3555333 0.6766089
## 9995 more rows ...</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
